<div class="topbar">
    <div class="topbar-left">
        <h1>{{ isEditing ? 'Editando: ' + (user.name || '') : 'Nuevo usuario:'}}</h1>
    </div>
    <div class="topbar-right">
        <button class="logout-button" (click)="logout()">
            <mat-icon>exit_to_app</mat-icon> Salir
        </button>
    </div>
</div>
<div class="user-form-container">
    <div class="user-form">
        <h2>Datos de los usuarios</h2>
        <form [formGroup]="userForm" (ngSubmit)="saveUser()">
            <div class="form-group">
                <label for="name">Nombre:</label>
                <input type="text" id="name" formControlName="name" placeholder="Equipo-fila-1">
                <div *ngIf="userForm.get('name')?.invalid && userForm.get('name')?.touched" class="error-message">
                    <div *ngIf="userForm.get('name')?.hasError('required')">Nombre es requerido</div>
                    <div *ngIf="userForm.get('name')?.hasError('minlength')">El nombre debe tener al menos 3 caracteres
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="email">Correo electrónico:</label>
                <input type="email" id="email" formControlName="email" placeholder="Intruduce Correo">
                <div *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="error-message">
                    <div *ngIf="userForm.get('email')?.hasError('required')">Correo es requerido</div>
                    <div *ngIf="userForm.get('email')?.hasError('pattern')">Correo inválido</div>
                </div>
            </div>

            <div class="form-group">
                <label for="phone">Teléfono:</label>
                <input type="text" id="phone" formControlName="phone" placeholder="09...">
                <div *ngIf="userForm.get('phone')?.invalid && userForm.get('phone')?.touched" class="error-message">
                    <div *ngIf="userForm.get('phone')?.hasError('required')">Teléfono es requerido</div>
                    <div *ngIf="userForm.get('phone')?.hasError('pattern')">Teléfono inválido</div>
                </div>
            </div>

            <div class="form-group">
                <label for="address">Dirección:</label>
                <input type="text" id="address" formControlName="address" placeholder="AV....">
                <div *ngIf="userForm.get('address')?.invalid && userForm.get('address')?.touched" class="error-message">
                    <div *ngIf="userForm.get('address')?.hasError('required')">Dirección es requerida</div>
                </div>
            </div>

            <div class="button-group">
                <button type="submit" class="save-button" [disabled]="userForm.invalid">
                    <mat-icon>save</mat-icon> Guardar
                </button>
                <button type="button" class="cancel-button" (click)="cancelForm()">
                    <mat-icon>cancel</mat-icon> Cancelar
                </button>
            </div>
        </form>
    </div>
</div>
<ngx-loading [show]="loading"></ngx-loading>